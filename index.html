<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äººç‰©ç‚¼é‡‘å° | Psyche Alchemist</title>
    <style>
        /* --- 0. å…¨å±€å˜é‡ï¼šé»‘é‡‘é…è‰² (ä¿®å¤ç‰ˆ) --- */
        :root {
            --bg-deep: #050505;
            --card-bg: rgba(16, 16, 16, 0.95); /* åŠ æ·±èƒŒæ™¯é˜²æ­¢é€è§†å¹²æ‰° */
            --gold-dim: #8a7348;
            --gold-bright: #ffdb8b; 
            --gold-glow: rgba(255, 215, 0, 0.25);
            --text-main: #e0d6c5;
            --border-color: #4a3b22;
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0;
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: "Songti SC", "SimSun", serif;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; padding: 20px;
            overflow-x: hidden;
        }

        /* --- 1. èƒŒæ™¯ç‰¹æ•ˆ (ä¿®å¤äº¤äº’é˜»æŒ¡é—®é¢˜) --- */
        .bg-layer, #dust-container {
            position: fixed; /* æ”¹ä¸º fixed é˜²æ­¢æ»šåŠ¨é—®é¢˜ */
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; /* å…³é”®ä¿®å¤ï¼šè®©ç‚¹å‡»ç©¿é€èƒŒæ™¯ */
            z-index: -1;
        }

        .bg-layer {
            background: 
                radial-gradient(circle at 30% 20%, rgba(80, 50, 10, 0.3) 0%, transparent 60%),
                radial-gradient(circle at 70% 80%, rgba(100, 70, 20, 0.2) 0%, transparent 60%);
            animation: breathe 10s ease-in-out infinite alternate;
        }
        @keyframes breathe {
            0% { opacity: 0.6; transform: scale(1); }
            100% { opacity: 0.9; transform: scale(1.05); }
        }

        .dust {
            position: absolute;
            background: var(--gold-bright);
            border-radius: 50%;
            box-shadow: 0 0 6px var(--gold-bright); 
            animation: float linear infinite;
            opacity: 0;
        }
        @keyframes float {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            50% { opacity: 0.8; }
            100% { transform: translateY(-10vh) scale(1); opacity: 0; }
        }

        /* --- 2. é¡¶éƒ¨å¯¼èˆª --- */
        .header {
            width: 100%; max-width: 1000px;
            display: flex; justify-content: space-between; align-items: flex-start;
            margin-bottom: 25px; z-index: 10;
            position: relative; /* ç¡®ä¿å±‚çº§æ­£ç¡® */
        }
        .title-group h1 {
            margin: 0; font-size: 1.8rem; color: var(--gold-bright);
            letter-spacing: 5px; 
            text-shadow: 0 0 15px var(--gold-glow); 
            font-weight: normal;
        }
        .title-group p { margin: 6px 0 0; font-size: 0.8rem; color: var(--gold-dim); letter-spacing: 3px; }

        .top-btns { display: flex; gap: 10px; }
        .nav-btn {
            background: rgba(0,0,0,0.6);
            border: 1px solid var(--gold-dim);
            color: var(--gold-bright);
            padding: 8px 16px; /* åŠ å¤§ç‚¹å‡»åŒºåŸŸ */
            font-size: 0.85rem; border-radius: 4px;
            cursor: pointer; transition: all 0.3s;
            backdrop-filter: blur(5px);
            white-space: nowrap;
        }
        .nav-btn:hover, .nav-btn:active {
            background: var(--gold-dim); color: #000;
            box-shadow: 0 0 20px var(--gold-glow);
        }

        /* --- 3. é…ç½®åŒº --- */
        .config-bar {
            width: 100%; max-width: 1000px;
            background: rgba(20, 15, 5, 0.6);
            border: 1px solid var(--border-color);
            padding: 18px; border-radius: 8px;
            display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            z-index: 5;
        }
        .input-group { flex: 1; min-width: 200px; display: flex; flex-direction: column; gap: 6px; }
        .input-label { font-size: 0.75rem; color: var(--gold-dim); letter-spacing: 1px; }
        .glod-input {
            background: rgba(0,0,0,0.5); border: 1px solid var(--border-color);
            color: var(--gold-bright); padding: 10px 12px; border-radius: 4px;
            font-family: inherit; font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
            transition: 0.3s;
        }
        .glod-input:focus { border-color: var(--gold-bright); box-shadow: 0 0 15px var(--gold-glow); }

        /* --- 4. ä¸»å·¥ä½œåŒº --- */
        .main-container {
            display: flex; gap: 30px; width: 100%; max-width: 1100px;
            flex-wrap: wrap; z-index: 5;
        }

        /* å·¦ä¾§æ§åˆ¶å° */
        .controls-panel {
            flex: 1; min-width: 300px;
            background: var(--card-bg);
            padding: 30px; border-radius: 10px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
            display: flex; flex-direction: column; gap: 24px;
        }

        /* æ ‡ç­¾ä¸è§£é‡Šå›¾æ ‡ */
        .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .control-label { color: var(--gold-bright); font-size: 1rem; text-shadow: 0 0 8px var(--gold-glow); letter-spacing: 1px; }
        
        .info-icon {
            color: var(--gold-dim); border: 1px solid var(--gold-dim);
            width: 20px; height: 20px; border-radius: 50%;
            font-size: 12px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s; opacity: 0.8;
            margin-left: 10px;
        }
        .info-icon:hover { opacity: 1; background: var(--gold-bright); color: #000; border-color: var(--gold-bright); }

        /* è§£é‡Šæ–‡æœ¬ (é»˜è®¤éšè—) */
        .info-text {
            font-size: 0.85rem; color: #a89f91; line-height: 1.6;
            background: rgba(0,0,0,0.4); 
            border-left: 2px solid var(--gold-dim);
            max-height: 0; overflow: hidden; 
            padding: 0 12px;
            transition: all 0.4s ease;
            margin-bottom: 0;
        }
        .info-text.show { max-height: 500px; padding: 12px; margin-bottom: 15px; }

        select.glod-select {
            width: 100%; background: #0a0a0a; border: 1px solid var(--border-color);
            color: var(--text-main); padding: 12px; border-radius: 4px;
            font-family: "Songti SC", serif; font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
            appearance: none; transition: 0.3s;
        }
        select.glod-select:focus { border-color: var(--gold-bright); box-shadow: 0 0 15px var(--gold-glow); }
        
        optgroup { color: var(--gold-dim); font-style: normal; font-weight: bold; background: #1a1a1a; }
        option { color: var(--text-main); background: #000; padding: 5px; }

        .alchemy-btn {
            margin-top: 20px; padding: 18px;
            background: linear-gradient(135deg, #2b2210 0%, #080808 100%);
            border: 1px solid var(--gold-dim);
            color: var(--gold-bright); font-size: 1.1rem; letter-spacing: 4px;
            cursor: pointer; border-radius: 4px; transition: all 0.2s;
            text-shadow: 0 0 8px var(--gold-glow);
            position: relative; overflow: hidden;
            z-index: 10; /* ä¿è¯æŒ‰é’®åœ¨æœ€ä¸Šå±‚ */
        }
        .alchemy-btn:active { transform: scale(0.98); }
        .alchemy-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* å³ä¾§ç»“æœ */
        .result-panel {
            flex: 1.5; min-width: 300px;
            background: rgba(10, 10, 10, 0.9); padding: 40px; border-radius: 6px;
            border: 1px solid var(--border-color); min-height: 600px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            position: relative;
        }
        .result-panel::before {
            content: ''; position: absolute; top: 12px; left: 12px; right: 12px; bottom: 12px;
            border: 1px solid rgba(138, 115, 72, 0.2); pointer-events: none;
        }
        #output-content {
            white-space: pre-wrap; line-height: 1.9; font-size: 1.05rem; opacity: 0.95;
            color: var(--text-main); height: 100%; overflow-y: auto;
            scrollbar-width: thin; scrollbar-color: var(--border-color) transparent;
        }
        h3 { color: var(--gold-bright); border-bottom: 1px solid var(--border-color); padding-bottom: 8px; margin-top: 30px; font-weight: normal; letter-spacing: 2px; }
        strong { color: var(--gold-bright); font-weight: normal; }
        blockquote { border-left: 3px solid var(--gold-dim); margin: 20px 0; padding-left: 20px; color: #bfaea8; font-style: italic; }

        /* --- 5. å¼¹çª— (ä¿®å¤æ’ç‰ˆä¸äº¤äº’) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 200; /* å±‚çº§æœ€é«˜ */
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.3s; backdrop-filter: blur(8px);
        }
        .modal-overlay.active { opacity: 1; pointer-events: all; }
        
        .modal-box {
            width: 90%; max-width: 650px; max-height: 85vh;
            background: #111; border: 1px solid var(--gold-dim);
            padding: 40px; border-radius: 8px;
            box-shadow: 0 0 60px rgba(212, 175, 55, 0.15);
            overflow-y: auto; 
            text-align: left; /* å…³é”®ä¿®å¤ï¼šå¼ºåˆ¶å·¦å¯¹é½ */
        }
        .modal-box h2 { 
            margin-top: 0; color: var(--gold-bright); 
            text-align: center; /* ä»…æ ‡é¢˜å±…ä¸­ */
            font-weight: normal; letter-spacing: 3px; 
            border-bottom: 1px solid #333; padding-bottom: 20px; margin-bottom: 20px; 
        }
        .modal-box h3 { color: var(--gold-dim); margin-top: 25px; font-size: 1.1rem; border: none; padding: 0;}
        .modal-box p, .modal-box li { color: #ccc; line-height: 1.8; font-size: 0.95rem; margin-bottom: 10px; }
        
        .close-modal {
            display: block; margin: 30px auto 0;
            background: transparent; border: 1px solid var(--gold-dim);
            color: var(--gold-dim); padding: 12px 40px; cursor: pointer; transition: 0.3s;
            font-size: 0.9rem; letter-spacing: 2px;
        }
        .close-modal:hover { background: var(--gold-dim); color: #000; }

        @media (max-width: 768px) {
            .header { flex-direction: column; gap: 15px; }
            .top-btns { width: 100%; justify-content: space-between; }
            .nav-btn { flex: 1; text-align: center; }
            .main-container { flex-direction: column; }
            .result-panel { min-height: 400px; padding: 20px; }
            .modal-box { padding: 25px; }
        }
    </style>
</head>
<body>

    <div class="bg-layer"></div>
    <div id="dust-container"></div>

    <div class="header">
        <div class="title-group">
            <h1>äººç‰©ç‚¼é‡‘å°</h1>
            <p>PSYCHE ALCHEMIST</p>
        </div>
        <div class="top-btns">
            <button class="nav-btn" onclick="openModal('theory')">ğŸ“œ åŸç† (Theory)</button>
            <button class="nav-btn" onclick="openModal('usage')">ğŸ”‘ ä½¿ç”¨æŒ‡å— (Guide)</button>
        </div>
    </div>

    <div class="config-bar">
        <div class="input-group">
            <span class="input-label">AI æœåŠ¡å•†</span>
            <select id="provider-select" class="glod-input" onchange="updateProvider()">
                <option value="silicon_cn" selected>ç¡…åŸºæµåŠ¨ (æ¨è)</option>
                <option value="silicon_com">ç¡…åŸºæµåŠ¨ (å¤‡ç”¨)</option>
                <option value="deepseek">DeepSeek å®˜æ–¹</option>
            </select>
        </div>
        <div class="input-group">
            <span class="input-label">æ¨¡å‹</span>
            <select id="model-select" class="glod-input">
                <option value="deepseek-ai/DeepSeek-V3" selected>DeepSeek-V3</option>
                <option value="deepseek-ai/DeepSeek-R1">DeepSeek-R1</option>
            </select>
        </div>
        <div class="input-group" style="flex: 2;">
            <span class="input-label">API Key</span>
            <input type="password" id="api-key" class="glod-input" placeholder="sk-...">
        </div>
    </div>

    <div class="main-container">
        <div class="controls-panel">
            
            <div class="control-item">
                <div class="label-row">
                    <label class="control-label">1. äººç‰©åŸå‹ (Archetype)</label>
                    <div class="info-icon" onclick="toggleInfo('info-archetype')">?</div>
                </div>
                <div id="info-archetype" class="info-text">
                    <strong>äººç‰©åŸå‹ï¼š</strong>åŸºäºè£æ ¼ã€ŠåŸå‹ä¸é›†ä½“æ— æ„è¯†ã€‹[CW 9i]ä¸æ–½å¯†ç‰¹ã€Šç»å…¸äººç‰©åŸå‹45ç§ã€‹ã€‚æ‰€æœ‰ç¥è¯åå­—ï¼ˆå¦‚ Apolloï¼‰å‡ä¸ºå¿ƒç†èƒ½é‡ä»£å·ã€‚æœ¬åˆ—è¡¨å·²åŒ…å«åŸä¹¦æ‰€æœ‰ä¸»ç¥åŠå…³é”®é…è§’ï¼ˆå¯¼å¸ˆã€ä¾¦æ¢ç­‰ï¼‰ï¼Œè¯·å°†å…¶ç†è§£ä¸ºäººç‰©çš„æ€§æ ¼åº•è‰²ã€‚
                </div>
                <select id="archetype" class="glod-select">
                    <option value="" disabled selected>-- è¯·é€‰æ‹©äººç‰©åŸå‹ --</option>
                    
                    <optgroup label="ã€ç†æ™ºä¸ç­–ç•¥ã€‘ (Apollo/Athena ç³»)">
                        <option value="å®å¹²å®¶ (Businessman/Apollo)">å®å¹²å®¶ (Apollo)</option>
                        <option value="å›å¾’ (Traitor)">å›å¾’ (Apollo Shadow)</option>
                        <option value="ç­–ç•¥å®¶ (Father's Daughter/Athena)">ç­–ç•¥å®¶ (Athena)</option>
                        <option value="èƒŒåæ…åˆ€è€… (Backstabber)">èƒŒåæ…åˆ€è€… (Athena Shadow)</option>
                        <option value="éšå£« (Recluse/Hades)">éšå£« (Hades)</option>
                        <option value="æœ¯å£« (Warlock)">æœ¯å£« (Hades Shadow)</option>
                        <option value="å¯¼å¸ˆ (Mentor)">å¯¼å¸ˆ (Mentor)</option>
                        <option value="ä¾¦æ¢ (Investigator)">ä¾¦æ¢ (Investigator)</option>
                    </optgroup>

                    <optgroup label="ã€æƒåŠ›ä¸ç»Ÿæ²»ã€‘ (Zeus/Hera ç³»)">
                        <option value="é¢†è¢–/å›½ç‹ (King/Zeus)">é¢†è¢– (Zeus)</option>
                        <option value="ç‹¬è£è€… (Dictator)">ç‹¬è£è€… (Zeus Shadow)</option>
                        <option value="å¥³æ—é•¿ (Matriarch/Hera)">å¥³æ—é•¿ (Hera)</option>
                        <option value="æ€¨å¦‡ (Scorned Woman)">æ€¨å¦‡ (Hera Shadow)</option>
                        <option value="æ³•è€/ä¸“åˆ¶è€… (Pharaoh)">ä¸“åˆ¶è€… (Pharaoh)</option>
                        <option value="ç ´åè€… (Destroyer)">ç ´åè€… (Destroyer)</option>
                        <option value="ç»Ÿæ²»è€… (Ruler)">ç»Ÿæ²»è€… (Ruler)</option>
                    </optgroup>

                    <optgroup label="ã€æƒ…æ„Ÿä¸å¥‰çŒ®ã€‘ (Demeter/Poseidon/Isis ç³»)">
                        <option value="ç…§é¡¾è€… (Nurturer/Demeter)">ç…§é¡¾è€… (Demeter)</option>
                        <option value="è¿‡åº¦æ§åˆ¶çš„æ¯äº² (Over-controlling Mother)">æ§åˆ¶ç‹‚æ¯äº² (Demeter Shadow)</option>
                        <option value="è‰ºæœ¯å®¶ (Artist/Poseidon)">è‰ºæœ¯å®¶ (Poseidon)</option>
                        <option value="æ–½è™è€… (Abuser)">æ–½è™è€… (Poseidon Shadow)</option>
                        <option value="æ•‘ä¸–ä¸» (Savior/Isis)">æ•‘èµè€… (Isis)</option>
                        <option value="æç«¯åˆ†å­ (Zealot)">æç«¯åˆ†å­ (Isis Shadow)</option>
                        <option value="å¼¥èµ›äºš (Messiah/Osiris)">å¼¥èµ›äºš (Osiris)</option>
                        <option value="æƒ©ç½šè€… (Punisher)">æƒ©ç½šè€… (Osiris Shadow)</option>
                        <option value="å¥½æœ‹å‹ (Best Friend)">å¥½æœ‹å‹ (Best Friend)</option>
                    </optgroup>

                    <optgroup label="ã€è¡ŒåŠ¨ä¸ç”Ÿå­˜ã€‘ (Ares/Artemis ç³»)">
                        <option value="æˆ˜å£« (Warrior/Ares)">æˆ˜å£« (Ares)</option>
                        <option value="å¤ä»‡è€… (Avenger)">å¤ä»‡è€… (Ares Shadow)</option>
                        <option value="å¥³çŒæ‰‹ (Amazon/Artemis)">å¥³çŒæ‰‹ (Artemis)</option>
                        <option value="è›‡å‘å¥³å¦– (Gorgon)">è›‡å‘å¥³å¦– (Artemis Shadow)</option>
                        <option value="è§’æ–—å£« (Gladiator)">è§’æ–—å£« (Gladiator)</option>
                        <option value="å¹¸å­˜è€… (Survivor)">å¹¸å­˜è€… (Survivor)</option>
                    </optgroup>

                    <optgroup label="ã€è‡ªç”±ä¸å˜é©ã€‘ (Hermes/Dionysus ç³»)">
                        <option value="å¼„è‡£ (Fool/Hermes)">å¼„è‡£ (Hermes)</option>
                        <option value="æµæµªæ±‰ (Derelict)">æµæµªæ±‰ (Hermes Shadow)</option>
                        <option value="æµªå­ (Woman's Man/Dionysus)">æµªå­ (Dionysus)</option>
                        <option value="è¯±æƒ‘è€… (Seducer)">è¯±æƒ‘è€… (Dionysus Shadow)</option>
                        <option value="æ¢é™©å®¶ (Explorer)">æ¢é™©å®¶ (Explorer)</option>
                        <option value="èµŒå¾’ (Gambler)">èµŒå¾’ (Gambler)</option>
                    </optgroup>

                    <optgroup label="ã€ç¥ç§˜ä¸é­…åŠ›ã€‘ (Aphrodite/Hestia ç³»)">
                        <option value="ç¼ªæ–¯ (Muse/Aphrodite)">ç¼ªæ–¯ (Aphrodite)</option>
                        <option value="é»‘å¯¡å¦‡ (Femme Fatale)">é»‘å¯¡å¦‡ (Aphrodite Shadow)</option>
                        <option value="ç¥ç§˜ä¸»ä¹‰è€… (Mystic/Hestia)">ç¥ç§˜è€… (Hestia)</option>
                        <option value="èƒŒå›è€… (Betrayer)">ä¼ªå–„è€… (Hestia Shadow)</option>
                        <option value="å°‘å¥³ (Maiden/Persephone)">å°‘å¥³ (Persephone)</option>
                        <option value="é—®é¢˜å°‘å¥³ (Troubled Teen)">é—®é¢˜å°‘å¥³ (Persephone Shadow)</option>
                        <option value="é­”æœ¯å¸ˆ (Magician)">é­”æœ¯å¸ˆ (Magician)</option>
                    </optgroup>
                </select>
            </div>

            <div class="control-item">
                <div class="label-row">
                    <label class="control-label">2. é˜´å½± (The Shadow)</label>
                    <div class="info-icon" onclick="toggleInfo('info-shadow')">?</div>
                </div>
                <div id="info-shadow" class="info-text">
                    <strong>é˜´å½±ï¼š</strong>é€šå¾€æ— æ„è¯†çš„â€œç‹­çª„ä¹‹é—¨â€[CW 9i]ã€‚å®ƒæ˜¯è¢«å‹æŠ‘çš„ç”Ÿå‘½åŠ›ã€‚æ²¡æœ‰é˜´å½±çš„äººç‰©æ˜¯çº¸ç‰‡äººã€‚
                </div>
                <select id="shadow" class="glod-select">
                    <option value="auto">ğŸ”® éšæœºåŒ¹é…ï¼</option>
                    <option value="ç‹¬è£è€… (The Tyrant)">ç‹¬è£è€… (The Tyrant)</option>
                    <option value="èƒŒå›è€… (The Traitor)">èƒŒå›è€… (The Traitor)</option>
                    <option value="æ¯ç­è€… (The Destroyer)">æ¯ç­è€… (The Destroyer)</option>
                    <option value="å—å®³è€… (The Victim)">å—å®³è€… (The Victim)</option>
                    <option value="æˆç˜¾è€… (The Addict)">æˆç˜¾è€… (The Addict)</option>
                    <option value="é»‘å¯¡å¦‡ (The Black Widow)">é»‘å¯¡å¦‡ (The Black Widow)</option>
                    <option value="å†·è¡€æœºå™¨ (The Robot)">å†·è¡€æœºå™¨ (The Robot)</option>
                    <option value="ç²¾ç¥å¸è¡€é¬¼ (The Vampire)">ç²¾ç¥å¸è¡€é¬¼ (The Vampire)</option>
                </select>
            </div>

            <div class="control-item">
                <div class="label-row">
                    <label class="control-label">3. æ—…ç¨‹é˜¶æ®µ (The Journey)</label>
                    <div class="info-icon" onclick="toggleInfo('info-stage')">?</div>
                </div>
                <div id="info-stage" class="info-text">
                    <strong>è‹±é›„ä¹‹æ—…ï¼š</strong>åŸºäºåè´å°”ã€Šåƒé¢è‹±é›„ã€‹ã€‚ç¥è¯æ˜¯å¿ƒç†æˆé•¿çš„éšå–»ã€‚å•ä¸€ç¥è¯ç»“æ„ï¼šå¯ç¨‹ã€è¯•ç‚¼ã€å½’æ¥ã€‚
                </div>
                <select id="stage" class="glod-select">
                    <option value="å¯ç¨‹ï¼šæ—¥å¸¸ç”Ÿæ´»çš„å´©å¡Œ">å¯ç¨‹ï¼šæ—¥å¸¸ç”Ÿæ´»çš„å´©å¡Œ (Call to Adventure)</option>
                    <option value="è¯•ç‚¼ï¼šé²¸é±¼ä¹‹è…¹">è¯•ç‚¼ï¼šé²¸é±¼ä¹‹è…¹ (Lowest Point)</option>
                    <option value="é«˜æ½®ï¼šä¸é˜´å½±çš„å†³æˆ˜">é«˜æ½®ï¼šä¸é˜´å½±çš„å†³æˆ˜ (The Ordeal)</option>
                    <option value="å½’æ¥ï¼šè·¨è¶Šå›å½’çš„é˜ˆé™">å½’æ¥ï¼šè·¨è¶Šå›å½’çš„é˜ˆé™ (The Return)</option>
                </select>
            </div>

            <div class="control-item">
                <label class="control-label">4. æ—¶ä»£èƒŒæ™¯ (Context)</label>
                <input type="text" id="context" class="glod-input" value="ç°ä»£éƒ½å¸‚" placeholder="ä¾‹ï¼š2077å¹´èµ›åšå¤œä¹‹åŸ...">
            </div>

            <button class="alchemy-btn" onclick="generateProfile()">âš—ï¸ æ³¨å…¥çµé­‚ Â· å¼€å§‹ç‚¼æˆ</button>
        </div>

        <div class="result-panel">
            <div id="output-content">
                <div style="text-align:center; color:#666; padding-top:100px;">
                    <p style="font-size:3rem; margin:0; opacity:0.3;">âš—ï¸</p>
                    <p>ç­‰å¾…ç‚¹ç‡ƒç‚¼é‡‘ä¹‹ç«...</p>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-theory" class="modal-overlay">
        <div class="modal-box">
            <h2>å¿ƒç†å­¦ä¸ç‚¼é‡‘æœ¯</h2>
            <div style="text-align:center; font-style:italic; color:#8a7348; margin-bottom:20px;">
                "åªè¦ä½ æ²¡æœ‰è§‰çŸ¥åˆ°æ½œæ„è¯†ï¼Œå®ƒå°±ä¼šä¸»å¯¼ä½ çš„ç”Ÿæ´»ï¼Œè€Œä½ ç§°ä¹‹ä¸ºå‘½è¿ã€‚"
            </div>
            <p><strong>ä¸ºä»€ä¹ˆå«â€œäººç‰©ç‚¼é‡‘å°â€ï¼Ÿ</strong><br>
            è£æ ¼åœ¨ã€Šå¿ƒç†å­¦ä¸ç‚¼é‡‘æœ¯ã€‹ä¸­æŒ‡å‡ºï¼Œä¸­ä¸–çºªç‚¼é‡‘æœ¯å£«è¯•å›¾å°†é“…å˜æˆé‡‘çš„è¿‡ç¨‹ï¼Œå®é™…ä¸Šæ˜¯äººç±»å¿ƒçµâ€œä¸ªæ€§åŒ–â€ï¼ˆIndividuationï¼‰çš„éšå–»ã€‚æœ¬å·¥å…·æ­£æ˜¯åŸºäºè¿™ä¸€ç†å¿µï¼šåˆ›ä½œäººç‰©çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å°†ç²—ç³™çš„æ€§æ ¼ç´ æï¼ˆé“…ï¼‰ï¼Œé€šè¿‡é˜´å½±çš„è¯•ç‚¼ï¼Œè½¬åŒ–ä¸ºå®Œæ•´çµé­‚ï¼ˆé‡‘ï¼‰çš„è¿‡ç¨‹ã€‚</p>
            <hr style="border:0; border-top:1px solid #333; margin:20px 0;">
            <h3>ç†è®ºåŸºçŸ³</h3>
            <ul>
                <li><strong>è£æ ¼åˆ†æå¿ƒç†å­¦ï¼š</strong> æä¾›â€œåŸå‹â€ä½œä¸ºå¿ƒç†ç»“æ„çš„åŸºç¡€ï¼Œæä¾›â€œé˜´å½±â€ä½œä¸ºåŠ¨åŠ›ã€‚</li>
                <li><strong>ç¥è¯å­¦ç†è®ºï¼š</strong> æä¾›â€œè‹±é›„ä¹‹æ—…â€ä½œä¸ºå™äº‹çš„æ—¶é—´è½´ã€‚</li>
                <li><strong>ç»å…¸äººç‰©åŸå‹45ç§ï¼š</strong> æä¾›45ç§åŸå‹çš„ç°ä»£è½¬è¯‘ã€‚</li>
            </ul>
            <button class="close-modal" onclick="closeModal('theory')">å…³é—­</button>
        </div>
    </div>

    <div id="modal-usage" class="modal-overlay">
        <div class="modal-box">
            <h2>ä½¿ç”¨æŒ‡å—</h2>
            <p>æœ¬å·¥å…·éœ€è¦æ¥å…¥ AI å¤§æ¨¡å‹ï¼ˆDeepSeekï¼‰æ¥é©±åŠ¨ã€‚</p>
            <ol>
                <li><strong>è·å– Keyï¼š</strong> æ¨èä½¿ç”¨ <a href="https://cloud.siliconflow.cn/" target="_blank" style="color:var(--gold-bright)">ç¡…åŸºæµåŠ¨</a> (æ³¨å†Œé€å…è´¹é¢åº¦)ã€‚</li>
                <li><strong>å¡«å…¥ Keyï¼š</strong> å°† sk- å¼€å¤´çš„å¯†é’¥ç²˜è´´åˆ°æœ¬é¡µé¡¶éƒ¨ã€‚</li>
                <li><strong>ç‚¹å‡» ? å›¾æ ‡ï¼š</strong> æŸ¥çœ‹æ¯ä¸ªå­¦æœ¯æ¦‚å¿µçš„æ·±åº¦è§£é‡Šã€‚</li>
                <li><strong>å¼€å§‹ï¼š</strong> é…ç½®å‚æ•°ï¼Œç‚¹å‡»ç‚¼æˆã€‚</li>
            </ol>
            <button class="close-modal" onclick="closeModal('usage')">æˆ‘æ˜ç™½äº†</button>
        </div>
    </div>

    <script>
        // --- ä¿®å¤ç‰ˆé€»è¾‘ï¼šç‰¹æ•ˆ ---
        function createDust() {
            const container = document.getElementById('dust-container');
            for(let i=0; i<45; i++) {
                const dust = document.createElement('div');
                dust.className = 'dust';
                dust.style.left = Math.random() * 100 + '%';
                dust.style.width = Math.random() * 4 + 'px';
                dust.style.height = dust.style.width;
                dust.style.setProperty('--duration', Math.random() * 5 + 6 + 's');
                dust.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(dust);
            }
        }
        createDust();

        // --- ä¿®å¤ç‰ˆé€»è¾‘ï¼šå¼¹çª—äº¤äº’ ---
        function openModal(id) { 
            const modal = document.getElementById('modal-' + id);
            if(modal) modal.classList.add('active');
        }
        function closeModal(id) { 
            const modal = document.getElementById('modal-' + id);
            if(modal) modal.classList.remove('active');
        }

        function toggleInfo(id) {
            const el = document.getElementById(id);
            if(el) el.classList.toggle('show');
        }

        // --- ä¿®å¤ç‰ˆé€»è¾‘ï¼šAPI ä¸ç”Ÿæˆ ---
        const providers = {
            'silicon_cn': 'https://api.siliconflow.cn/v1/chat/completions',
            'silicon_com': 'https://api.siliconflow.com/v1/chat/completions',
            'deepseek': 'https://api.deepseek.com/chat/completions'
        };

        const apiKeyInput = document.getElementById('api-key');
        if(localStorage.getItem('user_api_key')) apiKeyInput.value = localStorage.getItem('user_api_key');
        apiKeyInput.addEventListener('input', (e) => localStorage.setItem('user_api_key', e.target.value));

        function updateProvider() {
            // è¿™é‡Œå¯ä»¥æ·»åŠ åˆ‡æ¢é€»è¾‘æç¤ºï¼Œå½“å‰æš‚ä¸éœ€è¦é¢å¤–æ“ä½œ
        }

        async function generateProfile() {
            const providerKey = document.getElementById('provider-select').value;
            const baseUrl = providers[providerKey];
            const modelName = document.getElementById('model-select').value;
            const apiKey = apiKeyInput.value.trim();

            const archetype = document.getElementById('archetype').value;
            const shadow = document.getElementById('shadow').value;
            const stage = document.getElementById('stage').value;
            const context = document.getElementById('context').value;
            const outputDiv = document.getElementById('output-content');
            const btn = document.querySelector('.alchemy-btn');

            if (!apiKey) { alert("è¯·å…ˆå¡«å…¥ API Key"); return; }
            if (!archetype) { alert("è¯·é€‰æ‹©äººç‰©åŸå‹"); return; }

            btn.disabled = true;
            btn.innerHTML = "ğŸ”¥ ç‚¼é‡‘ä¹‹ç«ç‡ƒçƒ§ä¸­...";
            outputDiv.innerHTML = '<div style="text-align:center; color:#8a7348; margin-top:50px;">æ­£åœ¨è¿æ¥é›†ä½“æ— æ„è¯†...<br>è§£æ ' + archetype + '...</div>';

            const prompt = `
                ä½ æ˜¯ä¸€ä½ç²¾é€šè£æ ¼åˆ†æå¿ƒç†å­¦ã€ã€Šå¿ƒç†å­¦ä¸ç‚¼é‡‘æœ¯ã€‹åŠåè´å°”ç¥è¯å­¦çš„åˆ›æ„å†™ä½œä¸“å®¶ã€‚
                è¯·åŸºäºä»¥ä¸‹å‚æ•°ï¼Œé€šè¿‡â€œå¿ƒç†ç‚¼é‡‘â€çš„è¿‡ç¨‹ï¼Œç”Ÿæˆä¸€ä»½æ·±åº¦äººç‰©å°ä¼ ï¼ˆHTMLæ ¼å¼ï¼‰ï¼š
                
                1.åŸå‹(æ²³åºŠ)ï¼š${archetype} (å‚è€ƒã€Šç»å…¸äººç‰©åŸå‹45ç§ã€‹ï¼Œå¿…é¡»ç°ä»£åŒ–)
                2.é˜´å½±(åŠ¨åŠ›)ï¼š${shadow} (è¿™æ˜¯é€šå¾€æ— æ„è¯†çš„ç‹­çª„ä¹‹é—¨ï¼Œè¯·å±•ç¤ºå…¶ç”Ÿå‘½åŠ›ä¸ç ´ååŠ›)
                3.æ—…ç¨‹(æ—¶é—´)ï¼š${stage} (åè´å°”è‹±é›„ä¹‹æ—…ç»“æ„)
                4.èƒŒæ™¯ï¼š${context}

                è¯·æŒ‰ä»¥ä¸‹HTMLç»“æ„è¾“å‡ºï¼ˆå†·å³»ã€å¿ƒç†åŠ¨åŠ›å­¦è§†è§’ï¼‰ï¼š
                <h3>â… . äººç‰©ä¾§å†™ (Profile)</h3>
                <p>
                <strong>å§“åï¼š</strong>[éšæœº]<br>
                <strong>è¡¨è±¡èŒä¸šï¼š</strong>[ç¬¦åˆåŸå‹ä½†æœ‰åå·®æ„Ÿçš„ç°ä»£èŒä¸š] (ä¸¥ç¦å…¨éƒ¨ç”Ÿæˆç¨‹åºå‘˜æˆ–AIç›¸å…³å·¥ä½œï¼è¯·å¹¿æ³›å°è¯•ï¼šä½“åŠ›åŠ³åŠ¨è€…ã€ä¼ ç»Ÿæ‰‹è‰ºäººã€æœåŠ¡ä¸šã€åŒ»ç”Ÿã€æ•™å¸ˆã€è‰ºæœ¯å®¶ã€å…¬åŠ¡å‘˜ç­‰å…·æœ‰çƒŸç«æ°”çš„èŒä¸š)<br>
                <strong>æ ¸å¿ƒæ¬²æœ›ï¼š</strong>[åŸå‹åŠ¨åŠ›]<br>
                <strong>æœ€å¤§ææƒ§ï¼š</strong>[é˜´å½±ææƒ§]
                </p>

                <h3>â…¡. å¿ƒç†æ·±åº¦ (Psyche)</h3>
                <p><strong>å…‰æ˜çš„é¢å…· (Persona)ï¼š</strong>[ä»–åœ¨åˆ«äººçœ¼ä¸­çš„æ ·å­]</p>
                <p><strong>é˜´å½±çš„ä½è¯­ (Shadow)ï¼š</strong>[${shadow}å¦‚ä½•åœ¨æ— æ„è¯†ä¸­æ¥ç®¡ä»–ï¼Ÿå®ƒä¸ä»…æ˜¯é‚ªæ¶ï¼Œä¹Ÿæ˜¯è¢«å‹æŠ‘çš„ç”Ÿå‘½åŠ›ã€‚]</p>
                
                <h3>â…¢. ç‚¼é‡‘æ—¶åˆ» (${stage})</h3>
                <p><strong>å½“å‰çš„è¯•ç‚¼ï¼š</strong>[ç°å®å†²çªï¼Œéšå–»ç¥è¯å†…æ ¸]</p>
                <p><strong>è½¬åŒ–ä¸ç‰ºç‰²ï¼š</strong>[ä¸ºäº†å®Œæˆä¸ªæ€§åŒ–(Individuation)ï¼Œä»–å¿…é¡»ç‰ºç‰²ä»€ä¹ˆï¼Ÿ]</p>

                <h3>â…£. å‘½è¿ç‹¬ç™½</h3>
                <blockquote>â€œ[ä¸€å¥å°è¯]â€</blockquote>
            `;

            try {
                const response = await fetch(baseUrl, {
                    method: "POST",
                    headers: { "Content-Type": "application/json", "Authorization": `Bearer ${apiKey}` },
                    body: JSON.stringify({
                        model: modelName,
                        messages: [
                            {"role": "system", "content": "You are a creative writing assistant specialized in Jungian psychology."},
                            {"role": "user", "content": prompt}
                        ],
                        stream: true,
                        temperature: 0.8
                    })
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Error ${response.status}: ${errorText}`);
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder("utf-8");
                outputDiv.innerHTML = "";
                
                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;
                    const chunk = decoder.decode(value, { stream: true });
                    const lines = chunk.split('\n');
                    lines.forEach(line => {
                        if (line.startsWith('data: ')) {
                            const jsonStr = line.replace('data: ', '');
                            if (jsonStr === '[DONE]') return;
                            try {
                                const json = JSON.parse(jsonStr);
                                const content = json.choices[0].delta.content || "";
                                let formatted = content.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                                outputDiv.innerHTML += formatted;
                                outputDiv.scrollTop = outputDiv.scrollHeight;
                            } catch (e) {}
                        }
                    });
                }

            } catch (error) {
                outputDiv.innerHTML = `<div style="color:#a33; border:1px solid #a33; padding:15px;"><strong>ç‚¼æˆå¤±è´¥</strong><br>${error.message}</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = "âš—ï¸ æ³¨å…¥çµé­‚ Â· å¼€å§‹ç‚¼æˆ";
            }
        }
    </script>
</body>
</html>